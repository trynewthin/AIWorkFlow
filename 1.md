# 模块检查问题汇总

## 配置模块 (Config)

1. **缺失API路由和服务函数:**
   - 前端缺少 `getAllPipelineTypes` 的API路由定义和对应的服务函数
   - 在 `ipcApiRoute.ts` 中添加: `getAllPipelineTypes: 'controller/config/getAllPipelineTypes'`
   - 在 `configService.ts` 中添加对应的服务函数

2. **函数命名不一致:**
   - 后端方法是 `getNodeTypes`，前端路由是 `getConfigNodeTypes`
   - 建议保持命名一致性，可在前端或后端统一命名

3. **数据验证:**
   - 建议在前端服务层添加数据验证逻辑，确保API返回的数据符合预期的接口结构

4. **响应结构不一致:**
   - 后端返回 `{ code: 200, data: ..., success: true }`
   - 前端期望 `{ success: true, data: ..., message: ... }`
   - 建议统一响应结构

## 连接模块 (Connection)

1. **接口定义不一致:**
   - 后端返回 `{ status: 'success', message: '连接成功' }`
   - 前端API接口定义为 `ConnectionResponse { success: boolean; message: string; timestamp?: number; }`
   - 前端服务层接口定义为 `{ success: boolean; message: string; data?: { status: string; timestamp: number; version?: string; }; }`
   - 建议统一接口定义，确保前后端数据结构一致

2. **数据转换问题:**
   - 前端服务层从结果中提取 `result.data`，但后端并未返回 `data` 字段
   - 需要调整前端服务层代码适配后端实际返回的数据结构

## 知识库模块 (Knowledge)

1. **参数结构不一致:**
   - 后端 `ingestFromPath` 方法接收 `{knowledgeBaseId, sourcePath, metadata?}` 结构
   - 前端 API 定义 `IngestParams` 为 `{path, knowledgeBaseId, options?}` 结构
   - 实际上前端调用时需要将 `path` 映射到后端的 `sourcePath`
   - 建议统一参数命名，前端应与后端保持一致

2. **错误处理不一致:**
   - 后端在 `deleteDocument` 和 `deleteBase` 方法直接返回 `{ success: true }`
   - 其他方法则直接返回服务层结果，没有统一的错误处理
   - 建议后端统一响应格式，所有方法使用相同的结构 

3. **控制器参数解构:**
   - 知识库控制器的 `ingestFromPath` 没有显式解构参数
   - 直接传递整个 params 对象给服务层，没有参数验证
   - 建议参考其他模块实现参数验证和明确的解构

## 用户模块 (User)

1. **控制器实现完善:**
   - 用户控制器实现了完善的参数验证和错误处理
   - 每个方法都有 try/catch 并返回统一的响应格式
   - 值得其他模块借鉴这种处理方式

2. **服务层封装:**
   - 后端将 UserController 和 UserKeyController 分离，前端则整合在一起
   - 这种设计合理，前端可以简化接口调用

3. **错误信息保持一致:**
   - 前端应保持与后端相同的错误信息格式，便于调试和用户提示

## 工作流模块 (Workflow)

1. **参数处理一致性:**
   - 后端 `updateWorkflow` 方法检查并解构参数，构建更新对象
   - 与前端参数处理模式基本一致，但有细微差异
   - 建议完全统一参数结构和处理逻辑

2. **流程和运行时配置处理:**
   - 后端 `addNode` 方法直接调用配置服务获取默认配置
   - 前端通过额外的API调用获取这些配置
   - 建议统一处理方式，明确前端是否需要预先获取配置

3. **工作流所有权相关:**
   - 后端实现了详细的所有权检查和管理功能
   - 前端已正确对应这些功能
   - 但响应结构不完全一致，应统一

4. **响应格式统一:**
   - 工作流控制器使用 `{ code: 200, data: ..., success: true }` 格式
   - 前端期望 `{ success: true, data: ..., message: ... }` 格式
   - 建议统一响应格式，确保前后端一致
